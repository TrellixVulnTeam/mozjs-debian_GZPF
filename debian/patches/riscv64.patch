Index: mozjs68-68.6.0/build/moz.configure/init.configure
===================================================================
--- mozjs68-68.6.0.orig/build/moz.configure/init.configure
+++ mozjs68-68.6.0/build/moz.configure/init.configure
@@ -733,6 +733,9 @@ def split_triplet(triplet, allow_unknown
     elif cpu == 'sh4':
         canonical_cpu = 'sh4'
         endianness = 'little'
+    elif cpu == 'riscv64':
+        canonical_cpu = 'riscv64'
+        endianness = 'little'
     elif allow_unknown:
         canonical_cpu = cpu
         endianness = 'unknown'
Index: mozjs68-68.6.0/js/src/jit/AtomicOperations.h
===================================================================
--- mozjs68-68.6.0.orig/js/src/jit/AtomicOperations.h
+++ mozjs68-68.6.0/js/src/jit/AtomicOperations.h
@@ -391,7 +391,8 @@ inline bool AtomicOperations::isLockfree
 #elif defined(__ppc__) || defined(__PPC__) || defined(__sparc__) ||     \
     defined(__ppc64__) || defined(__PPC64__) || defined(__ppc64le__) || \
     defined(__PPC64LE__) || defined(__alpha__) || defined(__hppa__) ||  \
-    defined(__sh__) || defined(__s390__) || defined(__s390x__)
+    defined(__sh__) || defined(__s390__) || defined(__s390x__) ||       \
+    defined(__riscv)
 #  include "jit/shared/AtomicOperations-feeling-lucky.h"
 #else
 #  error "No AtomicOperations support provided for this platform"
Index: mozjs68-68.6.0/mfbt/tests/TestPoisonArea.cpp
===================================================================
--- mozjs68-68.6.0.orig/mfbt/tests/TestPoisonArea.cpp
+++ mozjs68-68.6.0/mfbt/tests/TestPoisonArea.cpp
@@ -169,6 +169,9 @@ static const ia64_instr _return_instr =
 #  define RETURN_INSTR _return_instr
 #  define RETURN_INSTR_TYPE ia64_instr
 
+#elif defined(__riscv)
+#define RETURN_INSTR 0x80828082 /* ret; ret */
+
 #else
 #  error "Need return instruction for this architecture"
 #endif
Index: mozjs68-68.6.0/python/mozbuild/mozbuild/configure/constants.py
===================================================================
--- mozjs68-68.6.0.orig/python/mozbuild/mozbuild/configure/constants.py
+++ mozjs68-68.6.0/python/mozbuild/mozbuild/configure/constants.py
@@ -50,6 +50,7 @@ CPU_bitness = {
     'mips64': 64,
     'ppc': 32,
     'ppc64': 64,
+    'riscv64': 64,
     's390': 32,
     's390x': 64,
     'sh4': 32,
@@ -89,6 +90,7 @@ CPU_preprocessor_checks = OrderedDict((
     ('mips64', '__mips64'),
     ('mips32', '__mips__'),
     ('sh4', '__sh__'),
+    ('riscv64', '__riscv && __riscv_xlen == 64'),
 ))
 
 assert sorted(CPU_preprocessor_checks.keys()) == sorted(CPU.POSSIBLE_VALUES)
Index: mozjs68-68.6.0/js/src/jit/shared/AtomicOperations-feeling-lucky-gcc.h
===================================================================
--- mozjs68-68.6.0.orig/js/src/jit/shared/AtomicOperations-feeling-lucky-gcc.h
+++ mozjs68-68.6.0/js/src/jit/shared/AtomicOperations-feeling-lucky-gcc.h
@@ -70,6 +70,11 @@
 #  endif
 #endif
 
+#if defined(__riscv) && __riscv_xlen == 64
+#  define HAS_64BIT_ATOMICS
+#  define HAS_64BIT_LOCKFREE
+#endif
+
 #ifdef JS_CODEGEN_NONE
 #  ifdef JS_64BIT
 #    define HAS_64BIT_ATOMICS
